# .github/workflows/ci.yml
# Copy this file to your repo's .github/workflows/ directory.
# This is identical in every NextNode repo â€” no modifications needed.
name: CI

on:
    push:
        branches: [main]
    pull_request:
    workflow_dispatch:
        inputs:
            release_mode:
                description: 'Release mode'
                required: false
                type: choice
                default: 'none'
                options:
                    - none
                    - release
                    - canary
            force:
                description: 'Force VPS recreation (destroy + recreate)'
                required: false
                type: boolean
                default: false

permissions:
    contents: write
    issues: write
    pull-requests: write

jobs:
    pipeline:
        uses: NextNodeSolutions/infrastructure/.github/workflows/pipeline.yml@main
        permissions:
            contents: write
            issues: write
            pull-requests: write
        with:
            release_mode: ${{ inputs.release_mode || 'none' }}
            force: ${{ inputs.force || false }}
        secrets: inherit
